---
layout: default
title: lenorix vCard
---

<form id="vcard" action="javascript:void(0);">
  <img id="vcard-qr" />

  <label for="firstname">Firstname:</label>
  <input type="text" id="vcard-firstname" name="firstname" required>
  <label for="surname">Surname:</label>
  <input type="text" id="vcard-surname" name="surname" required>

  <label for="email">Email:</label>
  <input type="email" id="vcard-email" name="email" required>
  <label for="phone">Phone:</label>
  <input type="tel" id="vcard-phone" name="phone" required>
</form>

<script type="text/javascript" defer>
  function vcard(firstname, surname, company, website, email, phone) {
    let vcard = "BEGIN:VCARD\n" +
      "VERSION:4.0\n" +
      "FN:" + firstname + " " + surname + "\n" +
      "N:" + surname + ";" + firstname + ";;;\n";
    
    if (company) vcard += "ORG:" + company + "\n";
    if (website) vcard += "URL:" + website + "\n";
    if (email) vcard += "EMAIL;TYPE=work:" + email + "\n";
    if (phone) vcard += "TEL;TYPE=work:" + phone + "\n";

    vcard += "END:VCARD\n";
    return vcard;
  }

  function updateQRCode() {
    let firstname = document.getElementById("vcard-firstname").value;
    let surname = document.getElementById("vcard-surname").value;
    let website = "{{ site.url }}";
    let email = document.getElementById("vcard-email").value;
    let phone = document.getElementById("vcard-phone").value;

    let vcardData = vcard(firstname, surname, "", website, email, phone);
    let vcardUrl = encodeURIComponent(vcardData);

    document.getElementById("vcard-qr").src = "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=" + vcardUrl;
  }

  function saveToLocalStorage(field) {
    const value = document.getElementById(field).value;
    localStorage.setItem(field, value);
  }

  function loadFromLocalStorage(field) {
    const value = localStorage.getItem(field);
    if (value) {
      document.getElementById(field).value = value;
    }
  }

  window.addEventListener("load", () => {
    document.querySelectorAll("#vcard input").forEach(input => {
      input.addEventListener("input", () => {
        //saveToLocalStorage(input.id);
        console.log(input.id);
        updateQRCode();
      });
      loadFromLocalStorage(input.id);
    });
    updateQRCode();
  });
</script>
